# 新規参加者向けガイド

## コードベースの全体構造
- プロジェクトはクリーンアーキテクチャに沿っており，`infra → interface → app → domain` の一方向依存を保つようにディレクトリが構成されています．各レイヤーの責務も `docs/architecture.md` に明記されており，外部接続を担う `infra`，入出力の変換を司る `interface`，ユースケースをまとめる `app`，純粋なエンティティ群を置く `domain` が階層的に連携します．
- 実行エントリーポイントは `src/maou/__main__.py` で，コンソール向けアプリケーションを `maou.infra.console.app.main` に委譲する構造です．CLI 全体の振る舞いを追う際はここから辿るとスムーズです．
- テストコードも同じレイヤー構造で整理されており，`tests/maou/{infra,interface,app,domain}` のように責務ごとに分割されています．コードを追加する際は対応するレイヤーのテストディレクトリを確認するのが近道です．

## 重要な開発ルールと運用フロー
- 依存関係や型安全性に関する厳密なルールがあります．特に「すべてのコードに型ヒントを付ける」「公開 API には必ず docstring を書く」「レイヤー間の依存を逆流させない」といった原則が必須です．
- 変更を行う際は Poetry のみを用いて依存管理・タスク実行を行い，`poetry run mypy`，`poetry run ruff format`，`pytest` などの品質チェックをパイプラインとして回すことが求められます．
- 新機能には網羅的なテスト，バグ修正には再発防止テストを追加することが明文化されています．テスト方針に迷った場合は AGENTS の該当セクションを参照してください．

## 開発環境セットアップの要点
- リポジトリは Dev Container を前提としており，`bash scripts/dev-init.sh` と `poetry run bash scripts/pre-commit.sh` を最初に実行して開発環境とフックを整備します．VS Code では `poetry env info --path` で得られる Python をインタプリタに設定します．
- Python のバージョン更新や Poetry キャッシュ削除，GCP/AWS 認証などの運用タスクも README にまとまっているので，クラウド連携や環境リフレッシュ時に参照するとよいです．

## 次に学習・確認しておきたい事項
1. **アーキテクチャ文書の精読**  
   `docs/architecture.md` を通読し，各レイヤーで許可される依存や代表的なコンポーネントを把握してください．クリーンアーキテクチャの前提を掴むことで新規実装時の判断がしやすくなります．
2. **レイヤー別の既存実装をトレース**  
   代表的なユースケース（例：前処理や学習フロー）を `interface → app → domain` の順に追い，データの受け渡しと責務分担を実地で確認しましょう．テストディレクトリの対応箇所も併せて読むと理解が深まります．
3. **品質チェック手順の習熟**  
   AGENTS で案内されているフォーマッタやリンタ，型チェック，テストのコマンドを実際に実行して，ローカルでの開発サイクルを確立してください．
4. **開発環境スクリプトの実行体験**  
   README に沿って初期化スクリプトやクラウド認証を試し，Poetry ベースのワークフローに慣れることをおすすめします．

